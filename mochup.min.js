(function(){var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v=Object.prototype.hasOwnProperty,w=function(a,b){function d(){this.constructor=a}for(var c in b)v.call(b,c)&&(a[c]=b[c]);return d.prototype=b.prototype,a.prototype=new d,a.__super__=b.prototype,a},x=Array.prototype.slice,y=function(a,b){return function(){return a.apply(b,arguments)}};o=[].indexOf||function(a){for(var b in this)if(this[b]===a&&~~b==b)return~~b;return-1},p=function(a){return{}.toString.call(a)==="[object Array]"},r=function(a,b){var c,d,e,f,g,h,i,j;g=0,f=0,d=a.charCodeAt(0),h=a.length;while(g<=h){e=0;while(d&&d!==60)d=a.charCodeAt(++g);f-g&&b("text",a.slice(f,f=g)),d=a.charCodeAt(f=++g);if(g>h)break;d===47&&(e=1,d=a.charCodeAt(f=++g));while(d&&(47<d&&d<58||96<d&&d<121||64<d&&d<91))d=a.charCodeAt(++g);j=a.slice(f,f=g);if(e)b("end",j),d=a.charCodeAt(f=++g);else{while(d&&(d===32||d===9||d===10||d===12||d===13))d=a.charCodeAt(f=++g);if(d&&d===62)d=a.charCodeAt(f=++g),b("start",j,null,m(j));else{c={};while(d!==62){while(d&&d!==0&&d!==34&&d!==39&&d!==62&&d!==47&&d!==61&&d!==32&&d!==9&&d!==10&&d!==12&&d!==13)d=a.charCodeAt(++g);i=a.slice(f,f=g);while(d&&(d===32||d===9||d===10||d===12||d===13))d=a.charCodeAt(f=++g);if(d===61){d=a.charCodeAt(f=++g);while(d&&(d===32||d===9||d===10||d===12||d===13))d=a.charCodeAt(f=++g);if(d===39){d=a.charCodeAt(f=++g);while(d&&d!==39)d=a.charCodeAt(++g);c[i]=a.slice(f,f=g),d=a.charCodeAt(f=++g)}else if(d===34){d=a.charCodeAt(f=++g);while(d&&d!==34)d=a.charCodeAt(++g);c[i]=a.slice(f,f=g),d=a.charCodeAt(f=++g)}else{while(d&&d!==34&&d!==39&&d!==61&&d!==60&&d!==62&&d!==96&&d!==32&&d!==9&&d!==10&&d!==12&&d!==13)d=a.charCodeAt(++g);c[i]=a.slice(f,f=g)}}else c[i]=i;while(d&&(d===32||d===9||d===10||d===12||d===13))d=a.charCodeAt(f=++g)}d=a.charCodeAt(f=++g),b("start",j,c,m(j))}}}},n=function(a){var b,c,d,e,f;b={};for(e=0,f=a.length;e<f;e++)c=a[e],b[c]=1;return d=function(a){return b.hasOwnProperty(a)},d.h=b,d},m=n("area,base,br,col,command,embed,hr,img,input,keygen,link,meta,param,source,track,wbr".split(",")),j=function(a,b){var c,d,e,f;c='return "',d=0;while(~(e=a.indexOf("{{",d)))c+=a.substring(d,e),f=a.substring(e+2,d=a.indexOf("}}",d)),c+='"+clean(_.'+f+')+"',b(f),d+=2;return Function("_","clean",c+a.substring(d)+'"')},h=function(a){return a===void 0?"":(""+a).replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;")},u=function(a,b,c){var d,e;return d={},e=j(a,function(a){return d[a]=b.get(a),b.on("change:"+a,function(){return d[a]=b.get(a),c(e(d,h))})}),e(d,h)},e="addEventListener"in document?function(a,b,c){return a.addEventListener(b,c,!1)}:function(a,b,c){return a.attachEvent("on#{event}",function(){return c.call(a,window.event)})},t={"m-bind":function(a,b,c,d){var f,g;return g=a.value,f=function(){var d;return(d=b.get(c))?a.type==="checkbox"?a.checked=!!d:a.value=d:0},b.on("change:"+c,f),d(function(){return f(),a.type==="checkbox"?e(a,"click",function(){return b.set(c,this.checked)}):e(a,a.type==="text"?"keyup":"change",function(){return g!==this.value&&b.set(c,this.value),g=this.value})})}},l=document.createElement("div"),s=function(a,b,c){var d;return b=/(?:\{\{|m\-)/.test(b)?b:document.getElementById(b).textContent.replace(/\s+</g," <").replace(/>\s+/g,"> ").replace(/^ | $/g,""),d=c,r(b,function(b,e,h,i){var j,k,m,n,o,p,q,r;switch(b){case"start":c===d&&a.on("dispose",function(){return l.appendChild(n),l.innerHTML=""}),n=c=c.appendChild(document.createElement(e));if(h){j=[],o=function(a){return j.push(a)};for(m in h)p=h[m],m in t?t[m](c,a,p,o):/\{\{/.test(p)?f(c,a,m,p,o):c.setAttribute(m,p);for(q=0,r=j.length;q<r;q++)k=j[q],k()}if(i)return c=c.parentNode;break;case"end":return c=c.parentNode;case"text":return g(c,a,e)}}),d},g=s.bind_text=function(a,b,c){var d;return/\{\{/.test(c)?a.appendChild(d=document.createTextNode(u(c,b,function(a){return d.nodeValue=a}))):a.appendChild(document.createTextNode(c)),d},f=function(a,b,c,d){return a.setAttribute(c,u(d,b,function(b){return a.setAttribute(c,b)}))},q=function(a,b){var c,d,e;b==null&&(b=0),d=a.length,c=new Array(d-b);for(e=b;b<=d?e<d:e>d;b<=d?e++:e--)c[e-b]=a[e];return c},b=function(){function a(){this.events_={}}return a.prototype.on=function(a,b){return this.events_[a]?p(this.events_[a])?this.events_[a].push(b):this.events_[a]=[this.events_[a],b]:this.events_[a]=b},a.prototype.off=function(a,b){var c,d,e,f,g;if(!(f=this.events_[a]))return this;if(!b)return this.events_[a]=null;if(p(f)){e=-1;for(d=0,g=f.length;d<g;d++)c=f[d],c===b&&(e=d);if(d<0)return this;f.splice(d,1)}else f===b&&delete this.events_[a];return this},a.prototype.emit=function(a,b,c){var d,e,f,g,h,i,j,k;if(!(g=this.events_[a]))return this;f=arguments.length;if("function"==typeof g){switch(arguments.length){case 1:g.call(this);break;case 2:g.call(this,b);break;case 3:g.call(this,b,c);break;default:g.apply(this,q(arguments,1))}return this}d=q(arguments,1),j=this.events_[a],k=[];for(h=0,i=j.length;h<i;h++)e=j[h],k.push(e.apply(this,d));return k},a}(),k=new b,c=function(a){function b(a){var c,d;b.__super__.constructor.apply(this,arguments),this.data_={},k.emit("init",this);for(c in a){if(!v.call(a,c))continue;d=a[c],p(d)?this.set.apply(this,[c].concat(d)):this.set(c,d)}}return w(b,a),b.prototype.set=function(){var a,c,d,e,f,g,h,i=this;d=arguments[0],e=arguments[1],c=3<=arguments.length?x.call(arguments,2):[];if(typeof d=="object")for(f in d)e=d[f],p(e)?this.set.apply(this,[f].concat(e)):this.set(f,e);else if(e instanceof b)e.on("change:"+c[0],function(){return i.change(d)}),this.data_[d]=function(){return e.get(c[0])};else{this.data_[d]=e,this.change(d);if(c){e.deps=c;for(g=0,h=c.length;g<h;g++)a=c[g],this.on("change:"+a,function(){return i.change(d)})}}return this},b.prototype.get=function(a){var b;return a=this.data_[a],"function"==typeof a?a.deps?a.apply(this,function(){var c,d,e,f;e=a.deps,f=[];for(c=0,d=e.length;c<d;c++)b=e[c],f.push(this.get(b));return f}.call(this)):a.call(this):a},b.prototype.change=function(a){return this.emit("change:"+a,a),this.emit("change",a)},b.prototype.dispose=function(a){return this.emit("dispose",a),delete this.data_,delete this.events_},b.prototype.render=function(a,b){return s(this,a,b)},b}(b),c.extend=function(a){var b,d;d=[];for(b in a){if(!v.call(a,b))continue;b==="init"?d.push(k.on(b,a[b])):d.push(c.prototype[b]=a[b])}return d},i=new b,a=function(a){function b(a,c){this.name=a,this.def_=c,b.__super__.constructor.apply(this,arguments),this.models_=[],i.emit("init",this)}return w(b,a),b.prototype.add=function(a){var b,d,e,f=this;d=new c({}),(b=this.def_)&&d.set(b);for(e in a)d.set(a);return d.on("change",function(a){return f.emit("change",a,d),f.emit("change:"+a,d)}),d.on("dispose",function(a){if(a!==!1)return f.remove(d,!0)}),this.models_.push(d),this.emit("add",d),d},b.prototype.at=function(a){return this.models_[a]},b.prototype.remove=function(a,b){var c;if("number"==typeof a){c=this.models_[a],this.models_.splice(a,1),this.emit("remove",c);if(!b)return c.dispose(!1)}else{this.models_.splice(o.call(this.models_,a),1),this.emit("remove",a);if(!b)return a.dispose(!1)}},b.prototype.each=function(a){var b,c,d,e,f;e=this.models_,f=[];for(b=0,d=e.length;b<d;b++)c=e[b],f.push(a.call(this,c,b));return f},b.prototype.where=function(a){var b,c,d,e;e=this.models_;for(b=0,d=e.length;b<d;b++){c=e[b];if(a.call(this,c,b))return c}return!1},b.prototype.filter=function(a){var b,c,d,e,f,g,h,i,j;c=[],i=this.models_;for(b=0,g=i.length;b<g;b++)d=i[b],a(d)===!1&&c.push(b);e=0,j=[];for(f=0,h=c.length;f<h;f++)b=c[f],j.push(this.remove(b-e++));return j},b.prototype.render=function(a,b){return this.each(function(c){return c.render(a,b)}),this.on("add",function(c){return c.render(a,b)})},b.prototype.size=function(){return this.models_.length},b}(b),a.extend=function(b){var c,d;d=[];for(c in b){if(!v.call(b,c))continue;c==="init"?d.push(i.on(c,b[c])):d.push(a.prototype[c]=b[c])}return d},d=function(a){function b(a){this.change=y(this.change,this),b.__super__.constructor.apply(this,arguments),a&&this.model(a)}return w(b,a),b.prototype.change=function(a){return this.emit("change:"+a),this.emit("change",a)},b.prototype.model=function(a){var b,c,d,e;this.model_&&this.model_.off("change",this.change),a.on("change",this.change),this.model_=a,d=a.data_,e=[];for(b in d)c=d[b],"function"!=typeof c?e.push(a.change(b)):e.push(void 0);return e},b.prototype.set=function(){var a;return(a=this.model_).set.apply(a,arguments)},b.prototype.get=function(){var a;return(a=this.model_).get.apply(a,arguments)},b.prototype.render=c.prototype.render,b}(b),window.mochup={parse:r,render:s,Model:c,Emitter:b,Collection:a,View:d,tmpl:u,attrs:t,indexOf:o}}).call(this)